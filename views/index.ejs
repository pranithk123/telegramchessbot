<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Chess</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
  background:#0d0d0d;
  color:white;
  font-family:Arial, sans-serif;
  height:100vh;
  margin:0;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction: column;
}

.container {
  text-align:center;
  /* Hidden by default until we check for redirect */
  display: none; 
}

.btn {
  background:#222;
  color:white;
  padding:20px 40px;
  margin:15px;
  display:block;
  font-size:24px;
  border-radius:15px;
  text-decoration:none;
  box-shadow:0 0 12px #111;
  transition:0.2s;
}

.btn:hover {
  background:#333;
  transform:scale(1.05);
}

/* Loader for the redirect split-second */
#loader { font-size: 20px; color: #888; }
</style>
</head>

<body>

  <div id="loader">Loading Chess...</div>

  <div class="container" id="menu">
    <h1>Chess Master</h1>
    <a class="btn" href="/quickplay">‚ôüÔ∏è Play Online</a>
    <a class="btn" href="/create-room">üë´ Play With Friend</a>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // 2. THE MAGIC REDIRECT LOGIC
    // Telegram sends the Room ID in the "start_param" field
    const roomId = tg.initDataUnsafe.start_param;

    if (roomId) {
      // If a Room ID exists, go straight there!
      window.location.href = `/room/${roomId}`;
    } else {
      // If no Room ID (regular visit), show the menu
      document.getElementById("loader").style.display = "none";
      document.getElementById("menu").style.display = "block";
    }
  </script>

</body>
</html>